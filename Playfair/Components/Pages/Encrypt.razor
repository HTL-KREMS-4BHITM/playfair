@page "/encrypt"
@using Model
@rendermode InteractiveServer

<h3>Playfair Verschlüsselung</h3>

<div class="mb-3">
    <label for="klartext" class="form-label">Klartext</label>
    <input id="klartext" @bind="inputText" class="form-control" placeholder="Text zum Verschlüsseln..." />
</div>

<div class="mb-3">
    <label for="schluessel" class="form-label">Schlüssel</label>
    <input id="schluessel" @bind="keyText" class="form-control" placeholder="Schlüssel zum Verschlüsseln..." />
</div>

<button class="btn btn-primary" @onclick="EncryptText">Verschlüsseln</button>

@if (!string.IsNullOrWhiteSpace(encryptedText))
{
    <div class="mt-3 alert alert-success">
        <strong>Verschlüsselter Text:</strong> @encryptedText
    </div>
}

@if (matrix != null)
{
    <h4>Generierte Matrix:</h4>
    <table class="table table-bordered">
        <thead>
        <tr>
            <th>1</th>
            <th>2</th>
            <th>3</th>
            <th>4</th>
            <th>5</th>
        </tr>
        </thead>
        <tbody>
        @for (int i = 0; i < 5; i++)
        {
            <tr>
                @for (int j = 0; j < 5; j++)
                {
                    <td>@matrix.Grid[i, j]</td>
                }
            </tr>
        }
        </tbody>
    </table>
}

@code {
    private string inputText = string.Empty;
    private string keyText = string.Empty;
    private string encryptedText = string.Empty;
    private Matrix matrix;

    private void EncryptText()
    {
        try
        {
            matrix = new Matrix(keyText);  // Matrix mit Schlüssel erstellen
            encryptedText = matrix.Encrypt(inputText);  // Verschlüsseln
        }
        catch
        {
            encryptedText = "Fehler bei der Verschlüsselung";
        }
    }
}